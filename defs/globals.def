
BUILD_PLATFORM := $(shell sh $(BUILD_ROOT)/rpmconf/Build/get_plat_tag.sh)

HOST    := $(shell hostname)
DATE    := $(shell date +%Y%m%d%H%M%S)
ifeq ($(RELEASE), )
    RELEASE := $(DATE)$(TAG)
else
	RELEASE := $(RELEASE)$(TAG)
	DATE   := $(RELEASE)
endif

MAJOR	:= $(shell cat RE/MAJOR)
MINOR	:= $(shell cat RE/MINOR)
MICRO	:= $(shell cat RE/MICRO)
BUILDNUM	:= $(shell cat RE/BUILD)

SOURCE_TAG := $(MAJOR).$(MINOR).$(MICRO)_$(BUILDNUM)
VERSION_TAG := $(MAJOR).$(MINOR).$(MICRO)_$(BUILDNUM).$(BUILD_PLATFORM)

ARCH := i386

ifeq ($(BUILD_PLATFORM), RHEL4_64)
	ARCH := x86_64
endif

ifeq ($(BUILD_PLATFORM), RHEL5_64)
	ARCH := x86_64
endif

ifeq ($(BUILD_PLATFORM), SLES10_64)
	ARCH := x86_64
endif

ifeq ($(BUILD_PLATFORM), UBUNTU6_64)
	ARCH := amd64
endif

ifeq ($(BUILD_PLATFORM), MACOSX)
	ARCH := ppc
endif

ifeq ($(TAG), )
	TAG := HEAD
else
	TAG	:= $(shell echo $$TAG)
endif

USER := $(shell id -un)

# EXECUTABLES

PERL 	:= $(shell which perl)

ifeq ($(PERL), )
	$(error perl not found - exiting)
endif

ANT		:= $(shell which ant)

ifeq ($(ANT), )
	$(error ant not found - exiting)
endif

PACKAGE_CONF_DIR	:= $(BUILD_ROOT)/rpmconf

PROFILE_SOURCE      := $(PACKAGE_CONF_DIR)/Env/zimbra.bash_profile
PROFILE_DEST        := .bash_profile
ENV_FILE_SOURCE     := $(PACKAGE_CONF_DIR)/Env/zimbra.bashrc
ENV_FILE_DEST       := .bashrc
EXRC_SOURCE         := $(PACKAGE_CONF_DIR)/Env/zimbra.exrc
EXRC_DEST           := .exrc
VIMINFO_SOURCE      := $(PACKAGE_CONF_DIR)/Env/zimbra.viminfo
VIMINFO_DEST        := .viminfo
LDAPRC_SOURCE       := $(PACKAGE_CONF_DIR)/Env/zimbra.ldaprc
LDAPRC_DEST         := .ldaprc

JAVA_HOME       ?= /usr/local/java
export JAVA_HOME

